Version 3 of my program.